package servlets;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.fasterxml.jackson.core.JsonProcessingException;

import controllers.HomeController;
import controllers.LoginController;
import controllers.ReimbursementController;

public class Dispatcher {

	public static void myVirtualRouter(HttpServletRequest req, HttpServletResponse res)
			throws JsonProcessingException, IOException, ServletException {
		
		System.out.println("\n\n\t\tIn MyDispatcher (myVirtualRouter())");
		System.out.println("Current URL: "+req.getRequestURL());
		System.out.println("Current URI: "+req.getRequestURI());
		
		
		switch(req.getRequestURI()) {
		case "/proj1-ers/forward/login":
			System.out.println("case 1");
			LoginController.login(req, res);
			break;
		case "/proj1-ers/home":
			System.out.println("case 2");
			HomeController.home(req, res);
			break;
		case "/proj1-ers/json/allUserReim":
			System.out.println("case 3");
			ReimbursementController.allUserReim(req, res);
			break;
		case "/proj1-ers/json/allVillsByName":
			System.out.println("case 3");
			break;
		case "/proj1-ers/json/getCurrentUserObject":
			//for project 1 you'll need an endpoint that will simply fetch the user's information from their session
			/*
			 * NOW....after you login the servlet will respond with the html page that you need....
			 * THEN....that html page will IMMEDIATELY FIRE ANOTHER AJAX REQUEST to retrieve that user's session
			 * data so that you can dom manipulation it into the html home page so you can say
			 * "hello [username]". The page is now modularized.
			 */
			break;
		default:
			System.out.println("Dude, you gave me a bad URI.");
			req.getRequestDispatcher("/resources/html/badlogin.html").forward(req, res);
			return;
			
		}
	}
}